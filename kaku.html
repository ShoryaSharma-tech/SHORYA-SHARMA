<<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RKGPT — Local Clone (HTML + JS)</title>
  <style>
    :root{--bg:#0f1724;--panel:#0b1220;--muted:#9aa4b2;--accent:#7c5cff;--user:#0ea5a4;--assistant:#1f2937}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#071024 0%, #071724 100%);color:#e6eef6}
    .app{max-width:1100px;margin:28px auto;display:grid;grid-template-columns:260px 1fr;gap:18px;padding:20px}
    .sidebar{background:rgba(255,255,255,0.03);padding:12px;border-radius:10px;display:flex;flex-direction:column;height:78vh}
    .brand{display:flex;gap:10px;align-items:center;padding:8px 4px}
    .logo{width:36px;height:36px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#00b4ff);display:flex;align-items:center;justify-content:center;font-weight:700}
    .convos{margin-top:8px;overflow:auto;padding-right:6px}
    .convo{padding:10px;border-radius:8px;margin-bottom:8px;background:rgba(255,255,255,0.02);cursor:pointer}
    .convo.active{background:linear-gradient(90deg,rgba(124,92,255,0.18),rgba(0,180,255,0.06))}
    .new-btn{margin-top:auto;padding:8px;border-radius:8px;border:1px dashed rgba(255,255,255,0.06);cursor:pointer;text-align:center;color:var(--muted)}
    .main{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:10px;display:flex;flex-direction:column;height:78vh}
    .header{padding:14px 18px;border-bottom:1px solid rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:space-between}
    .header h2{margin:0;font-size:16px}
    .chat{flex:1;overflow:auto;padding:18px;display:flex;flex-direction:column;gap:12px}
    .msg{max-width:78%;padding:12px 14px;border-radius:12px;line-height:1.4}
    .msg.user{margin-left:auto;background:linear-gradient(180deg,var(--user),#059669);color:#032; border-bottom-right-radius:4px}
    .msg.assistant{background:rgba(255,255,255,0.03);color:var(--muted);border-bottom-left-radius:4px}
    .controls{padding:12px;border-top:1px solid rgba(255,255,255,0.02);display:flex;gap:8px;align-items:center}
    textarea{flex:1;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit;resize:none;height:52px}
    button{padding:10px 14px;border-radius:8px;border:0;background:var(--accent);color:white;cursor:pointer}
    .meta{font-size:12px;color:var(--muted)}
    .actions{display:flex;gap:8px}
    .small{font-size:12px;padding:8px 10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);cursor:pointer}
    footer.note{font-size:12px;color:var(--muted);padding:8px;text-align:center}
    @media(max-width:820px){.app{grid-template-columns:1fr;padding:10px}.sidebar{display:none;height:auto}}
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">CG</div>
        <div>
          <div style="font-weight:700">ChatGPT - Local</div>
          <div class="meta">Client-only demo</div>
        </div>
      </div>
      <div class="convos" id="convos"></div>
      <div class="new-btn" id="newConv">+ New conversation</div>
    </aside>

    <main class="main">
      <div class="header">
        <h2 id="title">Welcome — Local chat</h2>
        <div class="actions">
          <button class="small" id="export">Export</button>
          <button class="small" id="clear">Clear</button>
        </div>
      </div>

      <section class="chat" id="chat"></section>

      <div class="controls">
        <textarea id="input" placeholder="Ask me something... (client-only, no AI backend)"></textarea>
        <button id="send">Send</button>
      </div>
    </main>
  </div>
  <footer class="note">Tip: open this file in VS Code and run with Live Server to test. Conversations saved in localStorage.</footer>

  <script>
    // Simple client-only ChatUI with persistent localStorage
    const convosEl = document.getElementById('convos');
    const chatEl = document.getElementById('chat');
    const inputEl = document.getElementById('input');
    const sendBtn = document.getElementById('send');
    const newConvBtn = document.getElementById('newConv');
    const exportBtn = document.getElementById('export');
    const clearBtn = document.getElementById('clear');
    const titleEl = document.getElementById('title');

    let store = JSON.parse(localStorage.getItem('cg_store') || 'null');
    if(!store){ store = {conversations:[], current: null}; save(); }

    function save(){ localStorage.setItem('cg_store', JSON.stringify(store)); }

    function formatTime(ts){ const d=new Date(ts); return d.toLocaleString(); }

    function addConvo(name='New chat'){ const c={id:Date.now()+Math.random(),name,created:Date.now(),messages:[]}; store.conversations.unshift(c); store.current=c.id; save(); render(); }

    function setCurrent(id){ store.current=id; save(); render(); }

    function deleteConvo(id){ store.conversations = store.conversations.filter(c=>c.id!==id); if(store.current===id) store.current = store.conversations[0]?store.conversations[0].id:null; save(); render(); }

    function renameConvo(id,newName){ const c=store.conversations.find(x=>x.id===id); if(c) c.name=newName; save(); render(); }

    function pushMessage(role, text){ const c = store.conversations.find(x=>x.id===store.current); if(!c) return; c.messages.push({id:Date.now()+Math.random(),role,text,ts:Date.now()}); save(); render(); chatEl.scrollTop = chatEl.scrollHeight; }

    function render(){ // sidebar
      convosEl.innerHTML = '';
      for(const c of store.conversations){
        const d = document.createElement('div'); d.className='convo' + (c.id===store.current?' active':'');
        d.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:600">${escapeHtml(c.name)}</div><div style="font-size:11px;color:var(--muted)">${formatTime(c.created)}</div></div>`;
        d.onclick = ()=>setCurrent(c.id);
        d.oncontextmenu = (e)=>{ e.preventDefault(); if(confirm('Delete conversation?')) deleteConvo(c.id); };
        d.ondblclick = ()=>{ const n = prompt('Rename conversation', c.name); if(n) renameConvo(c.id,n); };
        convosEl.appendChild(d);
      }

      // main chat
      chatEl.innerHTML='';
      const current = store.conversations.find(x=>x.id===store.current);
      if(!current){ titleEl.textContent='No conversation'; return; }
      titleEl.textContent = current.name;
      for(const m of current.messages){
        const el = document.createElement('div'); el.className = 'msg ' + (m.role==='user'?'user':'assistant');
        el.innerHTML = `<div style="font-size:13px">${escapeHtml(m.text).replace(/\n/g,'<br>')}</div><div style="font-size:11px;color:var(--muted);margin-top:6px">${formatTime(m.ts)}</div>`;
        chatEl.appendChild(el);
      }
      // auto focus last
      chatEl.scrollTop = chatEl.scrollHeight;
    }

    function escapeHtml(s){ return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    // Simple "assistant" that echoes with mild transformation to simulate reply
    function fakeAssistantReply(promptText){ // do a few simple transformations
      const trimmed = promptText.trim();
      if(!trimmed) return 'I didn\'t get that — try asking something else.';
      if(/hello|hi|hey/i.test(trimmed)) return 'Hello! How can I help you today?';
      if(/name/i.test(trimmed)) return "I'm a local demo assistant running in your browser.";
      // reverse words + short summary
      const words = trimmed.split(/\s+/);
      const first = words.slice(0,8).join(' ');
      const reversed = words.reverse().slice(0,12).join(' ');
      return `You said: "${first}${words.length>8?'...':''}"\n\nQuick reversed words sample: ${reversed}\n\n(Reply simulated locally; replace with a real API for real AI responses.)`;
    }

    sendBtn.addEventListener('click', ()=>{
      const txt = inputEl.value.trim(); if(!txt) return; pushMessage('user', txt); inputEl.value='';
      // typing indicator
      pushMessage('assistant', '⏳ Thinking...');
      // simulate delay
      setTimeout(()=>{
        const c = store.conversations.find(x=>x.id===store.current);
        if(!c) return;
        // remove last assistant placeholder
        if(c.messages.length && c.messages[c.messages.length-1].text.startsWith('⏳')) c.messages.pop();
        const reply = fakeAssistantReply(txt);
        pushMessage('assistant', reply);
      }, 700 + Math.random()*900);
    });

    inputEl.addEventListener('keydown', (e)=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); sendBtn.click(); } });

    newConvBtn.addEventListener('click', ()=> addConvo());
    exportBtn.addEventListener('click', ()=>{
      const c = store.conversations.find(x=>x.id===store.current);
      if(!c){ alert('No conversation to export'); return; }
      let out = `Conversation - ${c.name}\nCreated: ${new Date(c.created).toLocaleString()}\n\n`;
      for(const m of c.messages){ out += `[${m.role.toUpperCase()}] ${new Date(m.ts).toLocaleString()}\n${m.text}\n\n`; }
      const blob = new Blob([out], {type:'text/plain'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = (c.name.replace(/[^a-z0-9\-]/ig,'_')||'conversation') + '.txt'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    clearBtn.addEventListener('click', ()=>{
      if(!confirm('Clear ALL conversations from localStorage?')) return; localStorage.removeItem('cg_store'); store = {conversations:[], current:null}; render();
    });

    // create initial conversation if none
    if(store.conversations.length===0) addConvo('Welcome Chat');
    // helpful keyboard shortcuts
    window.addEventListener('keydown',(e)=>{
      if(e.ctrlKey && e.key==='k') { e.preventDefault(); inputEl.focus(); }
      if(e.ctrlKey && e.key==='n') { e.preventDefault(); addConvo(); }
    });

    render();
  </script>
</body>
</html>
